#include "lolevel.h"
#include "platform.h"
#include "core.h"

static long *nrflag = (long*)0x88d8; //found in sub_ffd0d528

#include "../../../generic/capt_seq.c"

void __attribute__((naked,noinline)) sub_FFD0D528_my(){ 
 asm volatile(
                 "STMFD   SP!, {R0-R10,LR}\n"
                 "MOV     R6, #0\n"
                 "MOV     R4, R0\n"
                 "BL      sub_FFD0E028\n"
                 "MVN     R1, #0\n"
                 "BL      sub_FFC173EC\n"
                 "MOV     R2, #4\n"
                 "ADD     R1, SP, #8\n"
                 "MOV     R0, #0x8A\n"
                 "BL      sub_FFC57424\n"
                 "TST     R0, #1\n"
                 "LDRNE   R1, =0x218\n"
                 "LDRNE   R0, =0xFFD0D73C\n"
                 "BLNE    sub_FFC0BDB8\n"
                 "LDR     R8, =0x1977C\n"
                 "LDR     R5, =0x196D0\n"
                 "LDRSH   R1, [R8,#0xE]\n"
                 "LDR     R0, [R5,#0x74]\n"
                 "BL      sub_FFCCBC30\n"
                 "BL      sub_FFC3302C\n"
                 "LDR     R2, =0x88DC\n"
                 "ADD     R3, R4, #0x8C\n"
                 "STRH    R0, [R4,#0x88]\n"
                 "STR     R2, [SP]\n"  //Was "STRD    R2, [SP,#0x30-0x30]\n"
                 "STR     R3, [SP,#4]\n" //
                 "MOV     R1, R0\n"
                 "LDRH    R0, [R5,#0x4C]\n"
                 "LDRSH   R2, [R8,#0xC]\n"
                 "LDR     R3, =0x88D8\n"
				 "BL      sub_FFD0E514\n"
                 "BL      wait_until_remote_button_is_released\n"
                 "BL      capt_seq_hook_set_nr\n"
                 "B       sub_FFD0D59C\n"
 );
}

void __attribute__((naked,noinline)) task_CaptSeqTask_my() //#fs
{
	asm volatile (
                "STMFD   SP!, {R3-R7,LR}\n"
                "LDR     R6, =0x52F8\n"

"loc_FFC48DC8:\n"
                "LDR     R0, [R6,#8]\n"
                "MOV     R2, #0\n"
                "MOV     R1, SP\n"
                "BL      sub_FFC1763C\n"
                "TST     R0, #1\n"
                "BEQ     loc_FFC48DF4\n"
                "LDR     R1, =0x48E\n"
                "LDR     R0, =0xFFC48AE8\n" // aSsshoottask_c ; SsShootTask.c
                "BL      sub_FFC0BDB8\n"    // Assert
                "BL      sub_FFC0BB70\n"    // ExitTask
                "LDMFD   SP!, {R3-R7,PC}\n"

"loc_FFC48DF4:\n"
                //LDR     R0, [SP,#0x18+var_18]
                "LDR     R0, [SP]\n"
                "LDR     R1, [R0]\n"

                "CMP     R1, #0x19\n"
                "ADDLS   PC, PC, R1,LSL#2\n"
                "B       loc_FFC49008\n"        // 0: error handler (invalid jump offset) (also when shutter half-pressed?)

                "B       loc_FFC48E70\n"        // 1: immediately after shutter release, !modify this one!
                "B       loc_FFC48E78\n"
                "B       loc_FFC48EF8\n"        // 3: default if shutter not pressed
                "B       loc_FFC48F0C\n"        // 4: after shutter release, when timed image preview active
                "B       loc_FFC48F04\n"        // 5: after shutter release, in detailed image review
                "B       loc_FFC48F14\n"
                "B       loc_FFC48F1C\n"
                "B       loc_FFC48F28\n"
                "B       loc_FFC48F80\n"        // 9: also ends with continuation of #1
                "B       loc_FFC48F0C\n"        // 10:
                "B       loc_FFC48F88\n"        // 11:
                "B       loc_FFC48F90\n"        // 12:
                "B       loc_FFC48F98\n"        // 13:
                "B       loc_FFC48FA0\n"        // 14:
                "B       loc_FFC48FA8\n"        // 15: in image-viewer
                "B       loc_FFC48FB4\n"
                "B       loc_FFC48FBC\n"
                "B       loc_FFC48FC4\n"
                "B       loc_FFC48FCC\n"
                "B       loc_FFC48FD8\n"
                "B       loc_FFC48FE0\n"
                "B       loc_FFC48FE8\n"
                "B       loc_FFC48FF0\n"
                "B       loc_FFC48FF8\n"
                "B       loc_FFC49000\n"
                "B       loc_FFC49014\n"
"loc_FFC48E70:\n"                               // #1
                "BL      sub_FFD0C090\n"        
                "BL      shooting_expo_param_override\n"  // +
                "B       loc_FFC48F20\n"
"loc_FFC48E78:\n"                               // #2
                "LDR     R4, [R0,#0xC]\n"
                "LDR     R0, [R4,#8]\n"
                "ORR     R0, R0, #1\n"
                "STR     R0, [R4,#8]\n"
				"BL      sub_FFD0C080\n"
                "MOV     R0, R4\n"
                "BL      sub_FFD0C468\n"
                "TST     R0, #1\n"
                "MOVNE   R2, R4\n"
                "MOVNE   R1, #1\n"
                "BNE     loc_FFC48F78\n"
                "BL      sub_FFD2ABAC\n"
                "BL      sub_FFC575B4\n"
                "STR     R0, [R4,#0x14]\n"
                "MOV     R0, R4\n"
                "BL      sub_FFD0D460\n"
                "BL      sub_FFD0DEC4\n"
                "MOV     R0, R4\n"
                "BL      sub_FFD0D528_my\n"         //--------------> 
                "BL      capt_seq_hook_raw_here\n"  //-------------->
				"MOV     R5, R0\n"
				"BL		 sub_FFD0EEA4\n"
				"BL      sub_FFD0EEE0\n"
                "MOV     R2, R4\n"
                "MOV     R1, #1\n"
				"MOV     R0, R5\n"
                "BL      sub_FFC4759C\n"
                "BL      sub_FFD0D8D8\n"
                "CMP     R0, #0\n"
                "LDRNE   R0, [R4,#8]\n"
                "ORRNE   R0, R0, #0x2000\n"
                "STRNE   R0, [R4,#8]\n"
                "B       loc_FFC49014\n"
"loc_FFC48EF8:\n"
                "MOV     R0, #1\n"
                "BL      sub_FFD0C224\n"
                "B       loc_FFC49014\n"
"loc_FFC48F04:\n"
                "BL      sub_FFD0BCF0\n"
                "B       loc_FFC49014\n"
"loc_FFC48F0C:\n"
                "BL      sub_FFD0C070\n"
                "B       loc_FFC49014\n"
"loc_FFC48F14:\n"
                "BL      sub_FFD0C078\n"
                "B       loc_FFC49014\n"
"loc_FFC48F1C:\n"
                "BL      sub_FFD0C144\n"
"loc_FFC48F20:\n"
                "BL      sub_FFC4721C\n"
                "B       loc_FFC49014\n"
"loc_FFC48F28:\n"
                "LDR     R4, [R0,#0xC]\n"
                "BL      sub_FFD0C080\n"
                "MOV     R0, R4\n"
                "BL      sub_FFD0C7E8\n"
                "TST     R0, #1\n"
                "MOV     R5, R0\n"
                "BNE     loc_FFC48F68\n"
                "BL      sub_FFC575B4\n"
                "STR     R0, [R4,#0x14]\n"
                "MOV     R0, R4\n"
                "BL      sub_FFD0D460\n"
                "MOV     R0, R4\n"
                "BL      sub_FFD0D938\n"
                "MOV     R5, R0\n"
                "LDR     R0, [R4,#0x14]\n"
                "BL      sub_FFC577C0\n"
"loc_FFC48F68:\n"
                "BL      sub_FFD0C070\n"
                "MOV     R2, R4\n"
                "MOV     R1, #9\n"
                "MOV     R0, R5\n"
"loc_FFC48F78:\n"
                "BL      sub_FFC4759C\n"
                "B       loc_FFC49014\n"
"loc_FFC48F80:\n"
                "BL      sub_FFD0C1A4\n"
                "B       loc_FFC48F20\n"
"loc_FFC48F88:\n"
                "BL      sub_FFD0CA64\n"
                "B       loc_FFC49014\n"
"loc_FFC48F90:\n"
                "BL      sub_FFD0CC4C\n"
                "B       loc_FFC49014\n"
"loc_FFC48F98:\n"
                "BL      sub_FFD0CCDC\n"
                "B       loc_FFC49014\n"
"loc_FFC48FA0:\n"
                "BL      sub_FFD0CD90\n"
                "B       loc_FFC49014\n"
"loc_FFC48FA8:\n"
                "MOV     R0, #0\n"
				"BL      sub_FFD0CF34\n"
                "B       loc_FFC49014\n"
"loc_FFC48FB4:\n"
                "BL      sub_FFD0D084\n"
                "B       loc_FFC49014\n"
"loc_FFC48FBC:\n"
                "BL      sub_FFD0D118\n"
                "B       loc_FFC49014\n"
"loc_FFC48FC4:\n"
                "BL      sub_FFD0D1E0\n"
                "B       loc_FFC49014\n"
"loc_FFC48FCC:\n"
				"BL      sub_FFD0C340\n"
				"BL      sub_FFC149A0\n"
				"B       loc_FFC49014\n"
"loc_FFC48FD8:\n"
				"BL      sub_FFD0CE4C\n"
				"B       loc_FFC49014\n"
"loc_FFC48FE0:\n"
                "BL      sub_FFD0CE90\n"
				"B       loc_FFC49014\n"
"loc_FFC48FE8:\n"
                "BL      sub_FFD0EE88\n"
                "B       loc_FFC49014\n"
"loc_FFC48FF0:\n"
                "BL      sub_FFD0EEA4\n"
                "B       loc_FFC49014\n"
"loc_FFC48FF8:\n"
                "BL      sub_FFD0EEB4\n"
                "B       loc_FFC49014\n"
"loc_FFC49000:\n"
                "BL      sub_FFD0EEE0\n"
                "B       loc_FFC49014\n"
"loc_FFC49008:\n"
                "LDR     R1, =0x58E\n"
                "LDR     R0, =0xFFC48AE8\n" // aSsshoottask_c ; SsShootTask.c
                "BL      sub_FFC0BDB8\n"    // Assert
"loc_FFC49014:\n"
                //"LDR     R0, [SP,#0x18+var_18]\n"
                "LDR     R0, [SP]\n"
                "LDR     R1, [R0,#4]\n"
                "LDR     R0, [R6,#4]\n"
                "BL      sub_FFC173B8\n"
                //"LDR     R4, [SP,#0x18+var_18]\n"
                "LDR     R4, [SP]\n"
                "LDR     R0, [R4,#8]\n"
                "CMP     R0, #0\n"
                "LDREQ   R1, =0x10D\n"
                "LDREQ   R0, =0xFFC48AE8\n" // aSsshoottask_c ; SsShootTask.c
                "BLEQ    sub_FFC0BDB8\n"    // Assert
                "MOV     R0, #0\n"
                "STR     R0, [R4,#8]\n"
                "B       loc_FFC48DC8\n"
    );
} //#fe


void __attribute__((naked,noinline)) exp_drv_task()
{
        asm volatile (
"       STMFD   SP!, {R4-R8,LR}\n"
"       SUB     SP, SP, #0x20\n"
"       LDR     R8, =0xBB8\n"
"       LDR     R7, =0x64FC\n"
"       LDR     R5, =0x3D41C\n"
"       MOV     R0, #0\n"
"       ADD     R6, SP, #0x10\n"
"       STR     R0, [SP,#0xC]\n"
"loc_FFC905F4:\n"
"       LDR     R0, [R7,#0x20]\n"
"       MOV     R2, #0\n"
"       ADD     R1, SP, #0x1C\n"
"       BL      sub_FFC1763C\n"
"       LDR     R0, [SP,#0xC]\n"
"       CMP     R0, #1\n"
"       BNE     loc_FFC9063C\n"
"       LDR     R0, [SP,#0x1C]\n"
"       LDR     R0, [R0]\n"
"       CMP     R0, #0x13\n"
"       CMPNE   R0, #0x14\n"
"       CMPNE   R0, #0x15\n"
"       BEQ     loc_FFC90758\n"
"       CMP     R0, #0x27\n"
"       BEQ     loc_FFC90730\n"
"       ADD     R1, SP, #0xC\n"
"       MOV     R0, #0\n"
"       BL      sub_FFC90584\n"
"loc_FFC9063C:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       LDR     R1, [R0]\n"
"       CMP     R1, #0x2C\n"
"       BNE     loc_FFC9066C\n"
"       LDR     R0, [SP,#0x1C]\n"
"       BL      sub_FFC91838\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R1, #1\n"
"       BL      sub_FFC173B8\n"
"       BL      sub_FFC0BB70\n"
"       ADD     SP, SP, #0x20\n"
"       LDMFD   SP!, {R4-R8,PC}\n"
"loc_FFC9066C:\n"
"       CMP     R1, #0x2B\n"
"       BNE     loc_FFC90688\n"
"       LDR     R2, [R0,#0x88]!\n"
"       LDR     R1, [R0,#4]\n"
"       MOV     R0, R1\n"
"       BLX     R2\n"
"       B       loc_FFC90BBC\n"
"loc_FFC90688:\n"
"       CMP     R1, #0x25\n"
"       BNE     loc_FFC906D8\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R1, #0x80\n"
"       BL      sub_FFC173EC\n"
"       LDR     R0, =0xFFC8D078\n"
"       MOV     R1, #0x80\n"
"       BL      sub_FFD03A20\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R2, R8\n"
"       MOV     R1, #0x80\n"
"       BL      sub_FFC172F0\n"
"       TST     R0, #1\n"
"       LDRNE   R1, =0xD1B\n"
"       BNE     loc_FFC9071C\n"
"loc_FFC906C4:\n"
"       LDR     R1, [SP,#0x1C]\n"
"       LDR     R0, [R1,#0x8C]\n"
"       LDR     R1, [R1,#0x88]\n"
"       BLX     R1\n"
"       B       loc_FFC90BBC\n"
"loc_FFC906D8:\n"
"       CMP     R1, #0x26\n"
"       BNE     loc_FFC90728\n"
"       ADD     R1, SP, #0xC\n"
"       BL      sub_FFC90584\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R1, #0x100\n"
"       BL      sub_FFC173EC\n"
"       LDR     R0, =0xFFC8D088\n"
"       MOV     R1, #0x100\n"
"       BL      sub_FFD03CA8\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R2, R8\n"
"       MOV     R1, #0x100\n"
"       BL      sub_FFC172F0\n"
"       TST     R0, #1\n"
"       BEQ     loc_FFC906C4\n"
"       LDR     R1, =0xD25\n"
"loc_FFC9071C:\n"
"       LDR     R0, =0xffc8d778\n" // "ExpDrv.c"
"       BL      sub_FFC0BDB8\n"
"       B       loc_FFC906C4\n"
"loc_FFC90728:\n"
"       CMP     R1, #0x27\n"
"       BNE     loc_FFC90740\n"
"loc_FFC90730:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       ADD     R1, SP, #0xC\n"
"       BL      sub_FFC90584\n"
"       B       loc_FFC906C4\n"
"loc_FFC90740:\n"
"       CMP     R1, #0x2A\n"
"       BNE     loc_FFC90758\n"
"       BL      sub_FFC7042C\n"
"       BL      sub_FFC711F8\n"
"       BL      sub_FFC70C7C\n"
"       B       loc_FFC906C4\n"
"loc_FFC90758:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       MOV     R4, #1\n"
"       LDR     R1, [R0]\n"
"       CMP     R1, #0x11\n"
"       CMPNE   R1, #0x12\n"
"       BNE     loc_FFC907C8\n"
"       LDR     R1, [R0,#0x7C]\n"
"       ADD     R1, R1, R1,LSL#1\n"
"       ADD     R1, R0, R1,LSL#2\n"
"       SUB     R1, R1, #8\n"
"       LDMIA   R1, {R2-R4}\n"
"       STMIA   R6, {R2-R4}\n"
"       BL      sub_FFC8F104\n"
"       LDR     R0, [SP,#0x1C]\n"
"       LDR     R1, [R0,#0x7C]\n"
"       LDR     R3, [R0,#0x88]\n"
"       LDR     R2, [R0,#0x8C]\n"
"       ADD     R0, R0, #4\n"
"       BLX     R3\n"
"       LDR     R0, [SP,#0x1C]\n"
"       BL      sub_FFC91C10\n"
"       LDR     R0, [SP,#0x1C]\n"
"       LDR     R1, [R0,#0x7C]\n"
"       LDR     R3, [R0,#0x90]\n"
"       LDR     R2, [R0,#0x94]\n"
"       ADD     R0, R0, #4\n"
"       BLX     R3\n"
"       B       loc_FFC90AFC\n"
"loc_FFC907C8:\n"
"       CMP     R1, #0x13\n"
"       CMPNE   R1, #0x14\n"
"       CMPNE   R1, #0x15\n"
"       BNE     loc_FFC9087C\n"
"       ADD     R3, SP, #0xC\n"
"       MOV     R2, SP\n"
"       ADD     R1, SP, #0x10\n"
"       BL      sub_FFC8F34C\n"
"       CMP     R0, #1\n"
"       MOV     R4, R0\n"
"       CMPNE   R4, #5\n"
"       BNE     loc_FFC90818\n"
"       LDR     R0, [SP,#0x1C]\n"
"       MOV     R2, R4\n"
"       LDR     R1, [R0,#0x7C]!\n"
"       LDR     R12, [R0,#0xC]!\n"
"       LDR     R3, [R0,#4]\n"
"       MOV     R0, SP\n"
"       BLX     R12\n"
"       B       loc_FFC90850\n"
"loc_FFC90818:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       CMP     R4, #2\n"
"       LDR     R3, [R0,#0x8C]\n"
"       CMPNE   R4, #6\n"
"       BNE     loc_FFC90864\n"
"       LDR     R12, [R0,#0x88]\n"
"       MOV     R0, SP\n"
"       MOV     R2, R4\n"
"       MOV     R1, #1\n"
"       BLX     R12\n"
"       LDR     R0, [SP,#0x1C]\n"
"       MOV     R2, SP\n"
"       ADD     R1, SP, #0x10\n"
"       BL      sub_FFC902D0\n"
"loc_FFC90850:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       LDR     R2, [SP,#0xC]\n"
"       MOV     R1, R4\n"
"       BL      sub_FFC90524\n"
"       B       loc_FFC90AFC\n"
"loc_FFC90864:\n"
"       LDR     R1, [R0,#0x7C]\n"
"       LDR     R12, [R0,#0x88]\n"
"       ADD     R0, R0, #4\n"
"       MOV     R2, R4\n"
"       BLX     R12\n"
"       B       loc_FFC90AFC\n"
"loc_FFC9087C:\n"
"       CMP     R1, #0x21\n"
"       CMPNE   R1, #0x22\n"
"       BNE     loc_FFC908C8\n"
"       LDR     R1, [R0,#0x7C]\n"
"       ADD     R1, R1, R1,LSL#1\n"
"       ADD     R1, R0, R1,LSL#2\n"
"       SUB     R1, R1, #8\n"
"       LDMIA   R1, {R2-R4}\n"
"       STMIA   R6, {R2-R4}\n"
"       BL      sub_FFC8E690\n"
"       LDR     R0, [SP,#0x1C]\n"
"       LDR     R1, [R0,#0x7C]\n"
"       LDR     R3, [R0,#0x88]\n"
"       LDR     R2, [R0,#0x8C]\n"
"       ADD     R0, R0, #4\n"
"       BLX     R3\n"
"       LDR     R0, [SP,#0x1C]\n"
"       BL      sub_FFC8E980\n"
"       B       loc_FFC90AFC\n"
"loc_FFC908C8:\n"
"       ADD     R1, R0, #4\n"
"       LDMIA   R1, {R2,R3,R12}\n"
"       STMIA   R6, {R2,R3,R12}\n"
"       LDR     R1, [R0]\n"
"       CMP     R1, #0x24\n"
"       ADDLS   PC, PC, R1,LSL#2\n"
"       B       loc_FFC90ADC\n" //default case
"loc_FFC908E4:\n"
"       B       loc_FFC90978\n"
"loc_FFC908E8:\n"
"       B       loc_FFC90978\n"
"loc_FFC908EC:\n"
"       B       loc_FFC90980\n"
"loc_FFC908F0:\n"
"       B       loc_FFC90988\n"
"loc_FFC908F4:\n"
"       B       loc_FFC90988\n"
"loc_FFC908F8:\n"
"       B       loc_FFC90988\n"
"loc_FFC908FC:\n"
"       B       loc_FFC90978\n"
"loc_FFC90900:\n"
"       B       loc_FFC90980\n"
"loc_FFC90904:\n"
"       B       loc_FFC90988\n"
"loc_FFC90908:\n"
"       B       loc_FFC90988\n"
"loc_FFC9090C:\n"
"       B       loc_FFC909E4\n"
"loc_FFC90910:\n"
"       B       loc_FFC909E4\n"
"loc_FFC90914:\n"
"       B       loc_FFC90AD0\n"
"loc_FFC90918:\n"
"       B       loc_FFC90AD8\n"
"loc_FFC9091C:\n"
"       B       loc_FFC90AD8\n"
"loc_FFC90920:\n"
"       B       loc_FFC90AD8\n"
"loc_FFC90924:\n"
"       B       loc_FFC90AD8\n"
"loc_FFC90928:\n"
"       B       loc_FFC90ADC\n"
"loc_FFC9092C:\n"
"       B       loc_FFC90ADC\n"
"loc_FFC90930:\n"
"       B       loc_FFC90ADC\n"
"loc_FFC90934:\n"
"       B       loc_FFC90ADC\n"
"loc_FFC90938:\n"
"       B       loc_FFC90ADC\n"
"loc_FFC9093C:\n"
"       B       loc_FFC90990\n"
"loc_FFC90940:\n"
"       B       loc_FFC90998\n"
"loc_FFC90944:\n"
"       B       loc_FFC90998\n"
"loc_FFC90948:\n"
"       B       loc_FFC909F0\n"
"loc_FFC9094C:\n"
"       B       loc_FFC909F0\n"
"loc_FFC90950:\n"
"       B       loc_FFC909F8\n"
"loc_FFC90954:\n"
"       B       loc_FFC90A28\n"
"loc_FFC90958:\n"
"       B       loc_FFC90A58\n"
"loc_FFC9095C:\n"
"       B       loc_FFC90A88\n"
"loc_FFC90960:\n"
"       B       loc_FFC90AB8\n"
"loc_FFC90964:\n"
"       B       loc_FFC90AB8\n"
"loc_FFC90968:\n"
"       B       loc_FFC90ADC\n"
"loc_FFC9096C:\n"
"       B       loc_FFC90ADC\n"
"loc_FFC90970:\n"
"       B       loc_FFC90AC0\n"
"loc_FFC90974:\n"
"       B       loc_FFC90AC8\n"
"loc_FFC90978:\n"
"       BL      sub_FFC8D560\n" //cases 0,1,6
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90980:\n"
"       BL      sub_FFC8D7F0\n" //cases 2,7
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90988:\n"
"       BL      sub_FFC8D9F4\n" //cases 3-5,8,9
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90990:\n"
"       BL      sub_FFC8DC5C\n" //case 22
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90998:\n"
"       BL      sub_FFC8DE50\n" //cases 23,24
"       B       loc_FFC90ADC\n" //default case
"loc_FFC909E4:\n"
"       BL      sub_FFC8E0B8_my\n" //cases 10,11 ->
"       MOV     R4, #0\n"
"       B       loc_FFC90ADC\n" //default case
"loc_FFC909F0:\n"
"       BL      sub_FFC8E1F4\n" //cases 25,26
"       B       loc_FFC90ADC\n" //default case
"loc_FFC909F8:\n"
"       LDRH    R1, [R0,#4]\n" //case 27
"       STRH    R1, [SP,#0x10]\n"
"       LDRH    R1, [R5,#2]\n"
"       STRH    R1, [SP,#0x12]\n"
"       LDRH    R1, [R5,#4]\n"
"       STRH    R1, [SP,#0x14]\n"
"       LDRH    R1, [R5,#6]\n"
"       STRH    R1, [SP,#0x16]\n"
"       LDRH    R1, [R0,#0xC]\n"
"       STRH    R1, [SP,#0x18]\n"
"       BL      sub_FFC918AC\n"
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90A28:\n"
"       LDRH    R1, [R0,#4]\n" //case 28
"       STRH    R1, [SP,#0x10]\n"
"       LDRH    R1, [R5,#2]\n"
"       STRH    R1, [SP,#0x12]\n"
"       LDRH    R1, [R5,#4]\n"
"       STRH    R1, [SP,#0x14]\n"
"       LDRH    R1, [R5,#6]\n"
"       STRH    R1, [SP,#0x16]\n"
"       LDRH    R1, [R5,#8]\n"
"       STRH    R1, [SP,#0x18]\n"
"       BL      sub_FFC91A2C\n"
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90A58:\n"
"       LDRH    R1, [R5]\n" //case 29
"       STRH    R1, [SP,#0x10]\n"
"       LDRH    R1, [R0,#6]\n"
"       STRH    R1, [SP,#0x12]\n"
"       LDRH    R1, [R5,#4]\n"
"       STRH    R1, [SP,#0x14]\n"
"       LDRH    R1, [R5,#6]\n"
"       STRH    R1, [SP,#0x16]\n"
"       LDRH    R1, [R5,#8]\n"
"       STRH    R1, [SP,#0x18]\n"
"       BL      sub_FFC91AD8\n"
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90A88:\n"
"       LDRH    R1, [R5]\n" //case 30
"       STRH    R1, [SP,#0x10]\n"
"       LDRH    R1, [R5,#2]\n"
"       STRH    R1, [SP,#0x12]\n"
"       LDRH    R1, [R5,#4]\n"
"       STRH    R1, [SP,#0x14]\n"
"       LDRH    R1, [R5,#6]\n"
"       STRH    R1, [SP,#0x16]\n"
"       LDRH    R1, [R0,#0xC]\n"
"       STRH    R1, [SP,#0x18]\n"
"       BL      sub_FFC91B78\n"
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90AB8:\n"
"       BL      sub_FFC8E468\n" //cases 31,32
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90AC0:\n"
"       BL      sub_FFC8EA84\n" //case 35
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90AC8:\n"
"       BL      sub_FFC8ECBC\n" //case 36
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90AD0:\n"
"       BL      sub_FFC8EE34\n" //case 12
"       B       loc_FFC90ADC\n" //default case
"loc_FFC90AD8:\n"
"       BL      sub_FFC8EFCC\n" //cases 13-16
"loc_FFC90ADC:\n"
"       LDR     R0, [SP,#0x1C]\n" //default case
"       LDR     R1, [R0,#0x7C]\n"
"       LDR     R3, [R0,#0x88]\n"
"       LDR     R2, [R0,#0x8C]\n"
"       ADD     R0, R0, #4\n"
"       BLX     R3\n"
"       CMP     R4, #1\n"
"       BNE     loc_FFC90B44\n"
"loc_FFC90AFC:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       MOV     R2, #0xC\n"
"       LDR     R1, [R0,#0x7C]\n"
"       ADD     R1, R1, R1,LSL#1\n"
"       ADD     R0, R0, R1,LSL#2\n"
"       SUB     R4, R0, #8\n"
"       LDR     R0, =0x3D41C\n"
"       ADD     R1, SP, #0x10\n"
"       BL      sub_FFE4EA44\n"
"       LDR     R0, =0x3D428\n"
"       MOV     R2, #0xC\n"
"       ADD     R1, SP, #0x10\n"
"       BL      sub_FFE4EA44\n"
"       LDR     R0, =0x3D434\n"
"       MOV     R2, #0xC\n"
"       MOV     R1, R4\n"
"       BL      sub_FFE4EA44\n"
"       B       loc_FFC90BBC\n"
"loc_FFC90B44:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       LDR     R0, [R0]\n"
"       CMP     R0, #0xB\n"
"       BNE     loc_FFC90B8C\n"
"       MOV     R3, #0\n"
"       STR     R3, [SP]\n"
"       MOV     R3, #1\n"
"       MOV     R2, #1\n"
"       MOV     R1, #1\n"
"       MOV     R0, #0\n"
"       BL      sub_FFC8D368\n"
"       MOV     R3, #0\n"
"       STR     R3, [SP]\n"
"       MOV     R3, #1\n"
"       MOV     R2, #1\n"
"       MOV     R1, #1\n"
"       MOV     R0, #0\n"
"       B       loc_FFC90BB8\n"
"loc_FFC90B8C:\n"
"       MOV     R3, #1\n"
"       MOV     R2, #1\n"
"       MOV     R1, #1\n"
"       MOV     R0, #1\n"
"       STR     R3, [SP]\n"
"       BL      sub_FFC8D368\n"
"       MOV     R3, #1\n"
"       MOV     R2, #1\n"
"       MOV     R1, #1\n"
"       MOV     R0, #1\n"
"       STR     R3, [SP]\n"
"loc_FFC90BB8:\n"
"       BL      sub_FFC8D4A8\n"
"loc_FFC90BBC:\n"
"       LDR     R0, [SP,#0x1C]\n"
"       BL      sub_FFC91838\n"
"       B       loc_FFC905F4\n"
        );
}


void __attribute__((naked,noinline)) sub_FFC8E0B8_my()
{
        asm volatile (
"       STMFD   SP!, {R4-R8,LR}\n"
"       LDR     R7, =0x64FC\n"
"       MOV     R4, R0\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R1, #0x3E\n"
"       BL      sub_FFC173EC\n"
"       LDRSH   R0, [R4,#4]\n"
"       MOV     R2, #0\n"
"       MOV     R1, #0\n"
"       BL      sub_FFC8D0FC\n"
"       MOV     R6, R0\n"
"       LDRSH   R0, [R4,#6]\n"
"       BL      sub_FFC8D208\n"
"       LDRSH   R0, [R4,#8]\n"
"       BL      sub_FFC8D260\n"
"       LDRSH   R0, [R4,#0xA]\n"
"       BL      sub_FFC8D2B8\n"
"       LDRSH   R0, [R4,#0xC]\n"
"       BL      sub_FFC8D310\n"
"       MOV     R5, R0\n"
"       LDR     R0, [R4]\n"
"       LDR     R8, =0x3D434\n"
"       CMP     R0, #0xB\n"
"       MOVEQ   R6, #0\n"
"       MOVEQ   R5, #0\n"
"       BEQ     loc_FFC8E148\n"
"       CMP     R6, #1\n"
"       BNE     loc_FFC8E148\n"
"       LDRSH   R0, [R4,#4]\n"
"       LDR     R1, =0xFFC8D068\n"
"       MOV     R2, #2\n"
"       BL      sub_FFD03B74\n"
"       STRH    R0, [R4,#4]\n"
"       MOV     R0, #0\n"
"       STR     R0, [R7,#0x28]\n"
"       B       loc_FFC8E150\n"
"loc_FFC8E148:\n"
"       LDRH    R0, [R8]\n"
"       STRH    R0, [R4,#4]\n"
"loc_FFC8E150:\n"
"       CMP     R5, #1\n"
"       LDRNEH  R0, [R8,#8]\n"
"       BNE     loc_FFC8E16C\n"
"       LDRSH   R0, [R4,#0xC]\n"
"       MOV     R2, #0x20\n"
"       LDR     R1, =0xFFC8D0EC\n"
"       BL      sub_FFC91868\n"
"loc_FFC8E16C:\n"
"       STRH    R0, [R4,#0xC]\n"
"       LDRSH   R0, [R4,#6]\n"
"       BL      sub_FFC70178_my\n" // ->
"       LDR     PC, =0xFFC8E178\n" // + continue in ROM
/* removed to spare some bytes -
"       LDRSH   R0, [R4,#8]\n"
"       MOV     R1, #1\n"
"       BL      sub_FFC70974\n"
"       MOV     R1, #0\n"
"       ADD     R0, R4, #8\n"
"       BL      sub_FFC709FC\n"
"       LDRSH   R0, [R4,#0xE]\n"
"       BL      sub_FFC84038\n"
"       LDR     R4, =0xBB8\n"
"       CMP     R6, #1\n"
"       BNE     loc_FFC8E1C4\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R2, R4\n"
"       MOV     R1, #2\n"
"       BL      sub_FFC172F0\n"
"       TST     R0, #1\n"
"       LDRNE   R1, =0x532\n"
"       LDRNE   R0, =0xffc8d778\n" // "ExpDrv.c"
"       BLNE    sub_FFC0BDB8\n"
"loc_FFC8E1C4:\n"
"       CMP     R5, #1\n"
"       LDMNEFD SP!, {R4-R8,PC}\n"
"       LDR     R0, [R7,#0x1C]\n"
"       MOV     R2, R4\n"
"       MOV     R1, #0x20\n"
"       BL      sub_FFC172F0\n"
"       TST     R0, #1\n"
"       LDRNE   R1, =0x537\n"
"       LDRNE   R0, =0xffc8d778\n" // "ExpDrv.c"
"       LDMNEFD SP!, {R4-R8,LR}\n"
"       BNE     sub_FFC0BDB8\n"
"       LDMFD   SP!, {R4-R8,PC}\n"
*/
        );
}


void __attribute__((naked,noinline)) sub_FFC70178_my()
{
        asm volatile (
"       STMFD   SP!, {R4-R6,LR}\n"
"       LDR     R5, =0x5FD4\n"
"       MOV     R4, R0\n"
"       LDR     R0, [R5,#4]\n"
"       CMP     R0, #1\n"
"       LDRNE   R1, =0x16D\n"
"       LDRNE   R0, =0xffc6ff10\n" // "Shutter.c"
"       BLNE    sub_FFC0BDB8\n"
"       CMN     R4, #0xC00\n"
"       LDREQSH R4, [R5,#2]\n"
"       CMN     R4, #0xC00\n"
"       LDREQ   R1, =0x173\n"
"       LDREQ   R0, =0xffc6ff10\n" // "Shutter.c"
"       STRH    R4, [R5,#2]\n"
"       BLEQ    sub_FFC0BDB8\n"
"       MOV     R0, R4\n"
//"       BL      sub_FFD68DD8\n" //-
"       BL      apex2us\n" //+
"       MOV     R4, R0\n"
//"       BL      nullsub\n" //-
//"       MOV     R0, R4\n" //-
"       BL      sub_FFCA2AF8\n"
"       TST     R0, #1\n"
"       LDMNEFD SP!, {R4-R6,LR}\n"
"       MOVNE   R1, #0x178\n"
"       LDRNE   R0, =0xffc6ff10\n" // "Shutter.c"
"       BNE     sub_FFC0BDB8\n"
"       LDMFD   SP!, {R4-R6,PC}\n"
        );
}
